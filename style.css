function toggleSection(id) {
  const allSections = document.querySelectorAll(".section");

  allSections.forEach(section => {
    if (section.id !== id && section.classList.contains("show")) {
      section.classList.remove("show");
      sessionStorage.setItem("section_" + section.id, false);
    }
  });

  const el = document.getElementById(id);
  if (!el) return;

  const isVisible = el.classList.contains("show");
  el.classList.toggle("show", !isVisible);
  sessionStorage.setItem("section_" + id, !isVisible);

  document.querySelectorAll(".button-grid button").forEach(btn => btn.classList.remove("active"));
  if (!isVisible) {
    const btnMap = {
      registerSection: "btn-register",
      searchSection: "btn-search",
      contactSection: "btn-contact",
      historySection: "btn-history",
      listSection: "btn-list"
    };
    const activeBtn = document.getElementById(btnMap[id]);
    if (activeBtn) activeBtn.classList.add("active");
  }
}
