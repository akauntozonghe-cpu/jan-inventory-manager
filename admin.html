<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ç®¡ç†ç”»é¢ - åœ¨åº«ç®¡ç†</title>

  <!-- å…±é€šã‚¹ã‚¿ã‚¤ãƒ« -->
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="admin.css" />
</head>
<body>

  <!-- å…±é€šãƒ˜ãƒƒãƒ€ãƒ¼èª­ã¿è¾¼ã¿å…ˆ -->
  <div id="headerContainer"></div>

  <!-- ãƒ˜ãƒƒãƒ€ãƒ¼èª­ã¿è¾¼ã¿ã¨ãƒ­ã‚¸ãƒƒã‚¯ -->
  <script type="module">
    fetch("header.html")
      .then(res => res.text())
      .then(html => {
        document.getElementById("headerContainer").innerHTML = html;
        import("./headerLogic.js").then(module => {
          if (module.initHeader) module.initHeader();
        });
      })
      .catch(err => {
        console.error("ãƒ˜ãƒƒãƒ€ãƒ¼èª­ã¿è¾¼ã¿å¤±æ•—:", err);
        document.getElementById("headerContainer").innerHTML =
          "<div style='color:red; padding:10px;'>ãƒ˜ãƒƒãƒ€ãƒ¼èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</div>";
      });
  </script>

  <!-- ç®¡ç†è€…å°‚ç”¨ãƒ¡ã‚¤ãƒ³ -->
  <main id="adminMain" aria-label="ç®¡ç†ç”»é¢">
    <h2>âš™ ç®¡ç†è€…ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h2>

    <!-- ä¿ç•™ã‚¢ã‚¤ãƒ†ãƒ ä¸€è¦§ -->
    <section>
      <h3>ğŸ“ ä¿ç•™ä¸­ã®ã‚¢ã‚¤ãƒ†ãƒ </h3>
      <div id="pendingItemsContainer"></div>
    </section>

    <!-- å±¥æ­´ -->
    <section>
      <h3>ğŸ“œ æ“ä½œå±¥æ­´</h3>
      <div id="historyContainer"></div>
    </section>

    <!-- é€šçŸ¥é€ä¿¡ãƒ•ã‚©ãƒ¼ãƒ  -->
    <section>
      <h3>ğŸ“¢ é€šçŸ¥é€ä¿¡</h3>
      <form id="sendNotificationForm">
        <label>ã‚¿ã‚¤ãƒˆãƒ«: <input type="text" id="notifTitle" required /></label><br>
        <label>æœ¬æ–‡: <textarea id="notifBody" required></textarea></label><br>
        <label>å¯¾è±¡:
          <select id="notifTarget">
            <option value="all">å…¨å“¡</option>
            <option value="admin">ç®¡ç†è€…ã®ã¿</option>
            <option value="uid:sample">ç‰¹å®šãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆä¾‹: uid:xxxxï¼‰</option>
          </select>
        </label><br>
        <button type="submit">é€ä¿¡</button>
      </form>
    </section>
  </main>

  <!-- ç®¡ç†ç”»é¢ãƒ­ã‚¸ãƒƒã‚¯ -->
  <script type="module" src="admin.js"></script>

  <!-- ãƒ­ã‚°ã‚¤ãƒ³ãƒã‚§ãƒƒã‚¯ï¼ˆDOMContentLoadedå¾Œã«å®Ÿè¡Œï¼‰ -->
  <script type="module">
    document.addEventListener("DOMContentLoaded", () => {
      const uid = localStorage.getItem("uid");
      const role = localStorage.getItem("role");

      if (!uid) {
        window.location.href = "index.html"; // æœªãƒ­ã‚°ã‚¤ãƒ³ãªã‚‰ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã¸
      } else if (role !== "ç®¡ç†è€…") {
        window.location.href = "home.html"; // ç®¡ç†è€…ä»¥å¤–ãªã‚‰ãƒ›ãƒ¼ãƒ ã¸
      }
    });
  </script>
</body>
</html>